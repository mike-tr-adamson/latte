mod common;
use common::{KEYSPACE, TABLE, LIMIT};
use latte::*;

pub async fn prepare(db) {
    common::prepare(db).await?;
    db.prepare(READ, `SELECT * FROM ${KEYSPACE}.${TABLE} WHERE c1 = ? OR c9 = ? LIMIT ${LIMIT}`).await?;
}

pub async fn run(db, i) {
    let c1 = hash2(i, 1) % C1;
    let c2 = hash2(i, 2) % C9;
    db.execute_prepared(READ, (c1, c9)).await
}
